\chapter{Files}


\section{{\tt seedname.win}}
INPUT. The master input file; contains the specification of the system
and any parameters for the run. For a description of input parameters,
see Chapter~\ref{chap:parameters}; for examples, see
Section~\ref{winfile} and the \wannier\
Tutorial.

\subsection{Units}

The following are the dimensional quantities that are
specified in the master input file:

\begin{itemize}
\item Direct lattice vectors
\item Positions (of atomic or projection) centres in real space
\item Energy windows
\item Positions of k-points in reciprocal space
\item Convergence thresholds for the minimisation of $\Omega$
%%\item \verb#zona# and \verb#box-size# (see Section~\ref{sec:proj})
\item \verb#zona# (see Section~\ref{sec:proj})
\item \verb#wannier_plot_cube#: cut-off radius for plotting WF in
  Gaussian cube format
\end{itemize}

Notes:

\begin{itemize}
\item The units (either \verb#ang#
  (default) or \verb#bohr#) in which the lattice vectors, atomic
  positions or projection centres are given can be set in the first
  line of the blocks 
  \verb#unit_cell_cart#, \verb#atoms_cart# and \verb#projections#,
  respectively, in \verb#seedname.win#.
\item Energy is always in eV.
\item Convergence thresholds are always in \AA$^{2}$
\item Positions of k-points are always in crystallographic
  coordinates relative to the reciprocal lattice vectors.
%%\item \verb#box-size# and \verb#zona# always in Angstrom and
%%  reciprocal Angstrom, respectively
\item \verb#zona# is always in reciprocal Angstrom (\AA$^{-1}$)
\item The keyword \verb#length_unit# may be set to \verb#ang#
  (default) or \verb#bohr#, in order to set the units in which the
  quantities in the output file {\tt seedname.wout} are written.
\item \verb#wannier_plot_radius# is in Angstrom
\end{itemize}

The reciprocal lattice vectors
$\{\mathbf{B}_{1},\mathbf{B}_{2},\mathbf{B}_{3}\}$ are defined in
terms
of the direct lattice vectors
$\{\mathbf{A}_{1},\mathbf{A}_{2},\mathbf{A}_{3}\}$ by the equation

\begin{equation}
\mathbf{B}_{1} = \frac{2\pi}{\Omega}\mathbf{A}_{2}\times\mathbf{A}_{3}
\ \ \ \mathrm{etc.},
\end{equation}

where the cell volume is
$V=\mathbf{A}_{1}\cdot(\mathbf{A}_{2}\times\mathbf{A}_{3})$.

\section{{\tt seedname.mmn}}
INPUT. Written by the underlying electronic structure code. See
Chapter~\ref{ch:wann-pp} for details.

\section{{\tt seedname.amn}}
INPUT. Written by the underlying electronic structure code. See
Chapter~\ref{ch:wann-pp} for details. 

\section{{\tt seedname.eig}}
INPUT. Written by the underlying electronic structure code. See
Chapter~\ref{ch:wann-pp} for details.

\section{{\tt seedname.nnkp}} \label{sec:old-nnkp}
OUTPUT. Written by \wannier\ when {\tt postproc\_setup=.TRUE.} (or,
alternatively, when \wannier\ is run with the {\tt -pp} command-line
option). See Chapter~\ref{ch:wann-pp} for details.

\section{{\tt seedname.wout}}
OUTPUT. The master output file. Here we give a description of the main
features of the output. The verbosity of the output is controlled by
the input parameter {\tt iprint}. The higher the value, the more
detail is given in the output file. The default value is 1, which prints
minimal information.

\subsection{Header}

The header provides some basic information about \wannier, the
authors, and the execution time of the current run.

\begin{verbatim}

             +---------------------------------------------------+
             |                                                   |
             |                     WANNIER90                     |
             |                                                   |
             +---------------------------------------------------+
             |                                                   |
             |        Welcome to the Maximally-Localized         |
             |        Generalized Wannier Functions code         |
             |            http://www.wannier.org                 |
             |                                                   |
             |  Authors:                                         |
             |    Arash A. Mostofi   (Imperial College London)   |
             |    Jonathan R. Yates  (University of Cambridge)   |
             |    Young-Su Lee       (KIST, S. Korea)            |
             |                                                   |
                                       .
                                       .
             |                                                   |
             |   Copyright (c) 1997-2007 J. Yates, A. Mostofi,   |
             |   Y.-S. Lee, N. Marzari, I. Souza, D. Vanderbilt  |
             |                                                   |
             |          Release: 1.1       1st Sep 2007          |
             |                                                   |
                                       .
                                       .
             |                                                   |
             +---------------------------------------------------+
             |    Execution started on 10Sep2007 at 12:46:57     |
             +---------------------------------------------------+

\end{verbatim}

\subsection{System information}

This part of the output file presents information that \wannier\ has
read or inferred from the master input file {\tt seedname.win}. This
includes real and reciprocal lattice vectors, atomic positions,
k-points, parameters for job control, disentanglement, localisation
and plotting. 

\begin{verbatim}
                                    ------
                                    SYSTEM
                                    ------
 
                              Lattice Vectors (Ang)
                    a_1     3.938486   0.000000   0.000000
                    a_2     0.000000   3.938486   0.000000
                    a_3     0.000000   0.000000   3.938486
 
                   Unit Cell Volume:      61.09251  (Ang^3)
 
                        Reciprocal-Space Vectors (Ang^-1)
                    b_1     1.595330   0.000000   0.000000
                    b_2     0.000000   1.595330   0.000000
                    b_3     0.000000   0.000000   1.595330
  
 *----------------------------------------------------------------------------*
 |   Site       Fractional Coordinate          Cartesian Coordinate (Ang)     |
 +----------------------------------------------------------------------------+
 | Ba   1   0.00000   0.00000   0.00000   |    0.00000   0.00000   0.00000    |
 | Ti   1   0.50000   0.50000   0.50000   |    1.96924   1.96924   1.96924    |
                                          .
                                          . 
 *----------------------------------------------------------------------------*
  
                                ------------
                                K-POINT GRID
                                ------------
  
             Grid size =  4 x  4 x  4      Total points =   64
  
 *---------------------------------- MAIN ------------------------------------*
 |  Number of Wannier Functions               :                 9             |
 |  Number of input Bloch states              :                 9             |
 |  Output verbosity (1=low, 5=high)          :                 1             |
 |  Length Unit                               :               Ang             |
 |  Post-processing setup (write *.nnkp)      :                 F             |
                                              .
                                              .
 *----------------------------------------------------------------------------*
\end{verbatim}

\subsection{Nearest-neighbour k-points}

This part of the output files provides information on the
$\mathrm{b}$-vectors and weights chosen to satisfy the condition of
Eq.~\ref{eq:B1}. 

\begin{verbatim}
 *---------------------------------- K-MESH ----------------------------------*
 +----------------------------------------------------------------------------+
 |                    Distance to Nearest-Neighbour Shells                    |
 |                    ------------------------------------                    |
 |          Shell             Distance (Ang^-1)          Multiplicity         |
 |          -----             -----------------          ------------         |
 |             1                   0.398833                      6            |
 |             2                   0.564034                     12            |
                                       .
                                       .
 +----------------------------------------------------------------------------+
 | The b-vectors are chosen automatically                                     |
 | The following shells are used:   1                                         |
 +----------------------------------------------------------------------------+
 |                        Shell   # Nearest-Neighbours                        |
 |                        -----   --------------------                        |
 |                          1               6                                 |
 +----------------------------------------------------------------------------+
 | Completeness relation is fully satisfied [Eq. (B1), PRB 56, 12847 (1997)]  |
 +----------------------------------------------------------------------------+
\end{verbatim}

\subsection{Disentanglement}

Then (if required) comes the part where $\omi$ is minimised to
disentangle the optimally-connected subspace of states for the
localisation procedure in the next step.

First, a summary of the energy windows that are being used is given:
\begin{verbatim}
 *------------------------------- DISENTANGLE --------------------------------*
 +----------------------------------------------------------------------------+
 |                              Energy  Windows                               |
 |                              ---------------                               |
 |                   Outer:    2.81739  to   38.00000  (eV)                   |
 |                   Inner:    2.81739  to   13.00000  (eV)                   |
 +----------------------------------------------------------------------------+
\end{verbatim}

Then, each step of the iterative minimisation of $\omi$ is reported. 
\begin{verbatim}                                   
                   Extraction of optimally-connected subspace                  
                   ------------------------------------------                  
 +---------------------------------------------------------------------+<-- DIS
 |  Iter     Omega_I(i-1)      Omega_I(i)      Delta (frac.)    Time   |<-- DIS
 +---------------------------------------------------------------------+<-- DIS
       1       3.82493590       3.66268867       4.430E-02      0.36    <-- DIS
       2       3.66268867       3.66268867       6.911E-15      0.37    <-- DIS
                                       .
                                       .
                                   
             <<<      Delta < 1.000E-10  over  3 iterations     >>>
             <<< Disentanglement convergence criteria satisfied >>>

        Final Omega_I     3.66268867 (Ang^2)

 +----------------------------------------------------------------------------+
\end{verbatim}
The first column gives the iteration number. For a description of the
minimisation procedure and expressions for $\omi^{(i)}$, see the
original paper~\cite{SMV}. The procedure is considered to be converged
when the fractional difference between $\omi^{(i)}$ and $\omi^{(i-1)}$ is
less than {\tt dis\_conv\_tol} over {\tt dis\_conv\_window}
iterations. The final column gives a running account of the wall time
(in seconds) so far. Note that at the end of each line of output,
there are the characters ``{\tt <-- DIS}''. This enables fast
searching of the output using, for example, the Unix command {\tt
  grep}:

{\tt my\_shell> grep DIS wannier.wout | less}

\subsection{Wannierisation}

The next part of the input file provides information on the
minimisation of $\omt$. At each iteration, the centre and spread of
each WF is reported.

\begin{verbatim}
*------------------------------- WANNIERISE ---------------------------------*
 +--------------------------------------------------------------------+<-- CONV
 | Iter  Delta Spread     RMS Gradient      Spread (Ang^2)      Time  |<-- CONV
 +--------------------------------------------------------------------+<-- CONV
 
 ------------------------------------------------------------------------------
 Initial State
  WF centre and spread    1  (  0.000000,  1.969243,  1.969243 )     1.52435832
  WF centre and spread    2  (  0.000000,  1.969243,  1.969243 )     1.16120620
                                      .
                                      .
      0     0.126E+02     0.0000000000       12.6297685260       0.29  <-- CONV
        O_D=      0.0000000 O_OD=      0.1491718 O_TOT=     12.6297685 <-- SPRD
 ------------------------------------------------------------------------------
 Cycle:      1
  WF centre and spread    1  (  0.000000,  1.969243,  1.969243 )     1.52414024
  WF centre and spread    2  (  0.000000,  1.969243,  1.969243 )     1.16059775
                                      .
                                      .
  Sum of centres and spreads ( 11.815458, 11.815458, 11.815458 )    12.62663472
 
      1    -0.313E-02     0.0697660962       12.6266347170       0.34  <-- CONV
        O_D=      0.0000000 O_OD=      0.1460380 O_TOT=     12.6266347 <-- SPRD
 Delta: O_D= -0.4530841E-18 O_OD= -0.3133809E-02 O_TOT= -0.3133809E-02 <-- DLTA
 ------------------------------------------------------------------------------
 Cycle:      2
  WF centre and spread    1  (  0.000000,  1.969243,  1.969243 )     1.52414866
  WF centre and spread    2  (  0.000000,  1.969243,  1.969243 )     1.16052405
                                      .
                                      .
   Sum of centres and spreads ( 11.815458, 11.815458, 11.815458 )    12.62646411
 
      2    -0.171E-03     0.0188848262       12.6264641055       0.38  <-- CONV
        O_D=      0.0000000 O_OD=      0.1458674 O_TOT=     12.6264641 <-- SPRD
 Delta: O_D= -0.2847260E-18 O_OD= -0.1706115E-03 O_TOT= -0.1706115E-03 <-- DLTA
 ------------------------------------------------------------------------------
                                      .
                                      .
 ------------------------------------------------------------------------------
 Final State
  WF centre and spread    1  (  0.000000,  1.969243,  1.969243 )     1.52416618
  WF centre and spread    2  (  0.000000,  1.969243,  1.969243 )     1.16048545
                                      .
                                      .
  Sum of centres and spreads ( 11.815458, 11.815458, 11.815458 )    12.62645344
 
         Spreads (Ang^2)       Omega I      =    12.480596753
        ================       Omega D      =     0.000000000
                               Omega OD     =     0.145856689
    Final Spread (Ang^2)       Omega Total  =    12.626453441
 ------------------------------------------------------------------------------
\end{verbatim}

It looks quite complicated, but things look more simple if one uses
{\tt grep}:

{\tt my\_shell> grep CONV wannier.wout}

gives

\begin{verbatim}
 +--------------------------------------------------------------------+<-- CONV
 | Iter  Delta Spread     RMS Gradient      Spread (Ang^2)      Time  |<-- CONV
 +--------------------------------------------------------------------+<-- CONV
      0     0.126E+02     0.0000000000       12.6297685260       0.29  <-- CONV
      1    -0.313E-02     0.0697660962       12.6266347170       0.34  <-- CONV
                                                   .
                                                   .
     50     0.000E+00     0.0000000694       12.6264534413       2.14  <-- CONV
\end{verbatim}

The first column is the iteration number, the second is the change in
$\Omega$ from the previous iteration, the third is the root-mean-squared
gradient of $\Omega$ with respect to variations in the unitary
matrices $\mathbf{U}^{(\mathbf{k})}$, and the last is the time taken (in
seconds). Depending on the input parameters used, the procedure either
runs for {\tt num\_iter} iterations, or a convergence criterion is
applied on $\Omega$. See Section~\ref{sec:wann_params} for details.

Similarly, the command

{\tt my\_shell> grep SPRD wannier.wout}

gives

\begin{verbatim}
        O_D=      0.0000000 O_OD=      0.1491718 O_TOT=     12.6297685 <-- SPRD
        O_D=      0.0000000 O_OD=      0.1460380 O_TOT=     12.6266347 <-- SPRD
                                            .
                                            .
        O_D=      0.0000000 O_OD=      0.1458567 O_TOT=     12.6264534 <-- SPRD         
\end{verbatim}

which, for each iteration, reports the value of the diagonal and
off-diagonal parts of the non-gauge-invariant spread, as well as the
total spread, respectively. Recall from Section~\ref{sec:method} that
$\Omega = \omi + \Omega_{\mathrm{D}} + \Omega_{\mathrm{OD}}$. 

\subsection{Plotting}

After WF have been localised, \wannier\ enters its plotting routines
(if required). For example, if you have specified an interpolated
bandstucture: 

\begin{verbatim}
 *---------------------------------------------------------------------------*
 |                               PLOTTING                                    |
 *---------------------------------------------------------------------------*
  
 Calculating interpolated band-structure
\end{verbatim}

\subsection{Summary timings}

At the very end of the run, a summary of the time taken for various
parts of the calculation is given. The level of detail is controlled
by the {\tt timing\_level} input parameter (set to 1 by default).

\begin{verbatim}
 *===========================================================================*
 |                             TIMING INFORMATION                            |
 *===========================================================================*
 |    Tag                                                Ncalls      Time (s)|
 |---------------------------------------------------------------------------|
 |kmesh: get                                        :         1         0.212|
 |overlap: read                                     :         1         0.060|
 |wann: main                                        :         1         1.860|
 |plot: main                                        :         1         0.168|
 *---------------------------------------------------------------------------*
 
 All done: wannier90 exiting
\end{verbatim}



\section{{\tt seedname.chk}}
INPUT/OUTPUT. Information required to restart the calculation or enter the
plotting phase. If we have used disentanglement this file also contains the
rectangular matrices $\bf{U}^{{\rm dis}({\bf k})}$.

%\section{{\tt seedname\_um.dat}}
%INPUT/OUTPUT. Contains $\bf{U}^{({\bf k})}$ and $\bf{M}^{(\bf{k,b})}$ (in the
%basis of the rotated Bloch states). Required to restart the calculation or enter the
%plotting phase.

\section{{\tt seedname.r2mn}}
OUTPUT.
Written if $\verb#write_r2mn#=\verb#true#$. The matrix elements
$\langle m|r^2|n\rangle$ (where $m$ and $n$ refer to MLWF)

\section{{\tt seedname\_band.dat}}
OUTPUT. Written if {\tt bands\_plot=.TRUE.}; The raw data for the
interpolated band structure.

\section{{\tt seedname\_band.gnu}}
OUTPUT. Written if {\tt bands\_plot=.TRUE.} and {\tt
  bands\_plot\_format=gnuplot}; A {\tt gnuplot} script to plot the
  interpolated band structure.

\section{{\tt seedname\_band.agr}}
OUTPUT. Written if {\tt bands\_plot=.TRUE.} and {\tt
  bands\_plot\_format=xmgrace}; A {\tt grace} file to plot the
  interpolated band structure.


\section{{\tt seedname\_band.kpt}}
OUTPUT. Written if {\tt bands\_plot=.TRUE.}; The k-points used for the
interpolated band structure, in units of the reciprocal lattice
vectors. This file can be used to generate a comparison band structure
from a first-principles code.

\section{{\tt seedname.bxsf}}
OUTPUT. Written if {\tt fermi\_surface\_plot=.TRUE.}; A Fermi surface plot file
suitable for plotting with XCrySDen.

\section{{\tt seedname\_w.xsf}}
OUTPUT. Written if {\tt wannier\_plot=.TRUE.} and {\tt
  wannier\_plot\_format=xcrysden}. Contains the {\tt
  w}$^{\mathrm{th}}$ WF in real space in a format suitable for
  plotting with XCrySDen or VMD, for example.

\section{{\tt seedname\_w.cube}}
OUTPUT. Written if {\tt wannier\_plot=.TRUE.} and {\tt
  wannier\_plot\_format=cube}. Contains the {\tt
  w}$^{\mathrm{th}}$ WF in real space in Gaussian cube format,
  suitable for plotting in XCrySDen, VMD, gopenmol etc.

\section{{\tt UNKp.s}}
INPUT. Read if \verb#wannier_plot#=\verb#.TRUE.# and used to plot the
MLWF.

The periodic part of the Bloch states represented on a regular real
 space grid, indexed by k-point \verb#p# (from 1 to \verb#num_kpts#)
 and spin \verb#s# (`1' for `up', `2' for `down').

The name of the wavefunction file is assumed to have the form:

\begin{verbatim}
    write(wfnname,200) p,spin
200 format ('UNK',i5.5,'.',i1)
\end{verbatim}

The first line of each file should contain 5 integers: the number of
 grid points in each direction (\verb#ngx#, \verb#ngy# and
 \verb#ngz#), the k-point number \verb#ik# and the total number of
 bands \verb#num_band# in the file. The full file will be read by \wannier\ as:

\begin{verbatim}
read(file_unit) ngx,ngy,ngz,ik,nbnd
do loop_b=1,num_bands
  read(file_unit) (r_wvfn(nx,loop_b),nx=1,ngx*ngy*ngz)
end do
\end{verbatim}

The file can be in formatted or unformatted style, this is controlled
by the logical keyword \verb#wvfn_formatted#. 


\section{{\tt seedname\_centres.xyz}}

OUTPUT. Written if {\tt translate\_home\_cell=.TRUE.}; xyz format
atomic structure file suitable for viewing with your favourite
visualiser ({\tt jmol}, {\tt gopenmol}, {\tt vmd}, etc.). 

\section{{\tt seedname\_hr.dat}}

OUTPUT. Written if {\tt hr\_plot=.TRUE.}. The first line gives the date and
time at which the file was created. The subsequent lines
each contain, respectively, the components of the vector $\mathbf{R}$
in terms of the lattice vectors $\{\mathbf{A}_{i}\}$, the indices $m$
and $n$, and the real and imaginary parts of the Hamiltonian matrix element
$H_{mn}^{(\mathbf{R})}$ in the WF basis, e.g.,

\begin{verbatim}
 Created on 24May2007 at 23:32:09                            
    0   0  -2    1    1   -0.001013    0.000000
    0   0  -2    2    1    0.000270    0.000000
    0   0  -2    3    1   -0.000055    0.000000
    0   0  -2    4    1    0.000093    0.000000
    0   0  -2    5    1   -0.000055    0.000000
    .
    .
    .
\end{verbatim}

